<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.menu.dao.MenuDao">
<!--统计菜单-->
    <select id="countMenuName" resultType="int" >
        select count(menu_name)
        from t_sys_menu
        where menu_name=#{menuName}
    </select>
<!--    新增菜单-->
    <insert id="addMenu" parameterType="com.menu.entity.MenuInfo">
        insert into t_sys_menu
        (
            menu_id,
            menu_name,
            parent_menu_code,
            menu_route,
            comment,
            is_deleted,
            create_people,
            create_time,
            update_people,
            update_time,
            version)
        values(
            #{menuId},
            #{menuName},
            #{parentMenuCode},
            #{menuRouter},
            #{menuComment},
            0,
            #{createPeople},
            now(),
            #{updatePeople},
            now(),
            0)
    </insert>
<!--    获取菜单详情-->
    <select id="findMenuById" parameterType="java.lang.String" resultType="com.menu.entity.MenuDetailVO">
        select
            menu_name  menuName,
            menu_route menuRouter,
            comment    menuComment
        from t_sys_menu
        where menu_id=#{menuId}
        and is_deleted=0
    </select>
<!--    修改菜单-->
    <update id="updateMenuById" parameterType="com.menu.entity.MenuInfo">
        update t_sys_menu
        set
            menu_name       =   #{menuName},
            menu_route      =   #{menuRouter},
            comment         =   #{menuComment},
            update_people   = #{updatePeople},
           update_time      =   now(),
            version         =   version+1
        where menu_id   =   #{menuId}
        and version     =   #{version}
    </update>
<!--    查询菜单列表-->
    <select id="listMenu" parameterType="com.menu.entity.MenuListVo" resultType="com.menu.entity.MenuListVo">
        select
            menu_id     menuId,
            menu_name   menuName,
            version     version
        from t_sys_menu
        where  is_deleted=0
    </select>
<!--    删除菜单-->
    <delete id="deleteMenu" parameterType="com.menu.entity.MenuInfo">
        update t_sys_menu
        set
            is_deleted=1,
            update_time = now(),
            update_people =#{userId},
            version = version+1
        where menu_id in
        <foreach item="item" collection="listId" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>
</mapper>